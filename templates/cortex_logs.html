{% extends "base.html" %}
{% block title %}Cortex API Logs{% endblock %}
{% block content %}
<div class="container mt-5">
    <h2>Cortex API Logs</h2>
    <div class="alert alert-info">
        Displaying endpoint data from Cortex XDR API.
    </div>
    {% if error %}
    <div class="alert alert-danger">
        {{ error }}
    </div>
    {% endif %}
    <div class="table-responsive">
        <table class="table table-striped table-bordered">
            <thead class="table-dark">
                <tr>
                    <th>Hostname</th>
                    <th>IP Address</th>
                    <th>OS</th>
                    <th>OS Version</th>
                    <th>Status</th>
                    <th>Last Seen</th>
                </tr>
            </thead>
            <tbody>
                {% if endpoints %}
                {% for endpoint in endpoints %}
                <tr>
                    <td>{{ endpoint.hostname | default('N/A') }}</td>
                    <td>{{ endpoint.ip | join(', ') if endpoint.ip else 'N/A' }}</td>
                    <td>{{ endpoint.os_type | default('N/A') }}</td>
                    <td>{{ endpoint.os_version | default('N/A') }}</td>
                    <td>{{ endpoint.endpoint_status | default('N/A') }}</td>
                    <td>{{ endpoint.last_seen | default('N/A') }}</td>
                </tr>
                {% endfor %}
                {% else %}
                <tr>
                    <td colspan="6" class="text-center">No endpoint data found.</td>
                </tr>
                {% endif %}
            </tbody>
        </table>
    </div>
</div>
{% endblock %}